// Entry point for the server
import app from "./app";
import config from "./config";
import { RobotStateServer } from "./websocket/RobotStateServer";
import { createServer } from "http";

const HTTP_PORT = Number(config.port) || 3000;

// Create HTTP server
const server = createServer(app);

// Start HTTP server
server.listen(HTTP_PORT, () => {
  console.log(`                                                                           
                                                                           
                                                                           
                                                                           
                                   +- -+                                   
                                 #-      -+.                               
                            .+-+.####-      .#.                            
                          #-     .+#####- .+- -                            
                      -+  ###+       +####    -                            
                   ++   +.######+.      -#    -                            
                  -#     ##########+.      -+ -                            
            .+. + -##     #####+#######-      -+        ++  .+.            
           +.    ++###.    ++    #########+ -+  +     -#+    .++           
           +#.    +####    +#     ##########-    -.   -####+.  +           
           +##     #####.  +##     ####+.####-    -   -####-   +           
           +###.    +####- +###.    #     ####-    +.  .+##- +-            
           +####-    -####-+####    ##     ####+    --     -               
           +#####-    +##########.  ###     ####+    .-                    
           +######-    +##########. ####     ####+    .-                   
           +#######-  -+###########-#####     +###+    .-                  
           +########+   +#################     +-+## .+#.                  
           +########+   +##################.    +#. .    .+.               
           +########+   +######- -##########.  -#####-      .+.            
           +########+   +####+    -##########+   +######-    .++           
           +########+  .######+    .#########.   +   +#####+   +           
           +########++.   .####+    -########.   +     +###-   +           
           +##########+     -###+    .#######.   +#+++  +##-   +           
           +#############+  -#####     ######.   +##-   +##-   +           
           +######################+     #####.   +##-   +##-   +           
             +#####################+     ####.   +##-   ++#+++             
                -####################  -++###.   +##-   +                  
                   -+#################.  -###.   ###-.+-                   
                      .+##############   -+##.   +  .                      
                          +###########   - -#. -+                          
                             -########   -  .-                             
                                -#####   +                                 
                                   -##+-                                   
                                                                           
                                                                           
                                                                           
                                                                           `);
  console.log(`Server is running on port ${HTTP_PORT}`);
});

// Initialize WebSocket server
new RobotStateServer(server);
